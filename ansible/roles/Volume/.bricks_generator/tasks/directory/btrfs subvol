---
- debug:
    msg: "Before {{ storage_partition }}"



- name: Create btrfs Subvolume for gluster
  ansible.builtin.command: "btrfs subvolume create {{ btrfs_main_volume }}"
  args:
    chdir: "{{export}}{{brick_number}}"
    creates: "{{export}}{{brick_number}}/{{ btrfs_main_volume }}"
  become: yes
  loop: "{{ storage_partition }}"
  loop_control:
    index_var: brick_number


- name: Create a directory inside btrfs subvolume
  become: true
  ansible.builtin.file:
    path: "{{export}}{{brick_number}}/{{ btrfs_main_volume }}/{{brick_final_dir}}"
    state: directory
  loop: "{{ storage_partition }}"
  loop_control:
    index_var: brick_number
